<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- add stylesheet links here -->
    <link href="/documentation/assets/styles/bower.css" rel="stylesheet">
  </head>

  <body>
  
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="http://www.pilrhealth.com" class="navbar-brand">PiLR Health</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/documentation/pages/getting-started">Getting Started</a>
        </li>
        <li class="active">
          <a href="/documentation/pages/tutorials">Tutorials</a>
        </li>
        <li>
          <a href="/documentation/pages/api">API </a>
        </li>
        <li>
          <a href="/documentation/pages/r-packages">R Packages</a>
        </li>
        <li>
          <a href="/documentation/pages/pilr-glossary">PiLR Glossary</a>
        </li>

      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://blog.pilrhealth.com">Blog</a></li> 
        <li><a href="/documentation">Docs Home</a></li> 
      </ul>
    </nav>
  </div>
</header>

  <div class="bs-docs-header" id="content">
      <div class="container">
        <img src="/documentation/assets/images/brand-text.png">
        <h1>Documentation</h1>
    </div>


      <a href="https://github.com/pilrhealth/documentation">
        <img style="position: absolute; top: 0; right: 0; border: 0;"
             src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
             alt="Fork me on GitHub"
             data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
  </div>

  
  <div class="container bs-docs-container">

      <div class="row">
        <div class="col-md-9" role="main">
          <div class="bs-docs-section">
<h2>Definitions and Schemas</h2>

<article>
  <h1 id="types-of-definitions">Types of Definitions</h1>
<p>All definitions are specified in a JSON format.</p>
<p>1) <strong>Filetype Definition</strong> - These define each type of file that a user would upload to PiLR. Most commonly, this will be a csv file, in which case the definition defines what variables the csv parser should look for and what dataset they should be mapped to.</p>
<p>2) <strong>Dataset Schema</strong> - These define the format of each dataset used within a project. Datasets can be added individually via the <em>Configuration</em> tab, or multiple datasets can be defined in an instrument definition. When the instrument is added to a project, the datasets are automatically imported with it.</p>
<p>3) <strong>Instrument Definition</strong> - An instrument is a device configured to upload data to PiLR. An instrument definition contains settings specific to that device, as well as schemas of each dataset that the instrument will write to. </p>
<h2 id="creating-a-filetype-definition">Creating a Filetype Definition</h2>
<p>If you wish to create your own filetype definition, you can use the following sample as a starting point. This is a simple defintion for a csv file that reads in a timestamp along with latitude and longitude data.  </p>
<p>The data_mappings section defines what the variable name is in the file (from_name) and what variable it should be written as in the dataset (to_name). The metadata_mappings section works the same way, but for metadata. In our system there are three possible metadata variables: id, pt (participant), and timestamp. If these are not included in the mappings, they will be automatically generated by PiLR. </p>
<p>Any columns in the file that are not included in the mappings will be ignored.</p>
<pre><code>{
  &quot;name&quot;: &quot;Sample CSV Filetype&quot;,
  &quot;code&quot;: &quot;pilrhealth:example:filetype&quot;,
  &quot;version&quot; : 1,
  &quot;description&quot;: &quot;A sample csv filetype definition for lat/lon data.&quot;,
  &quot;dataset&quot;: &quot;pilrhealth:example:dataset&quot;,
  &quot;dataset_version&quot;: 1,
  &quot;parser&quot;: {
    &quot;parse_by&quot;: &quot;column_name&quot;,
    &quot;col_name_row&quot;: 1,
    &quot;skip_rows&quot;: 1,
    &quot;null_expressions&quot;: [&quot;NaN&quot;, &quot;Inf&quot;, &quot;&quot;],
    &quot;date_format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;,
    &quot;data_mappings&quot;: [
      {
        &quot;from_name&quot;: &quot;lat&quot;,
        &quot;to_name&quot;: &quot;lat&quot;
      },
      {
        &quot;from_name&quot;: &quot;lon&quot;,
        &quot;to_name&quot;: &quot;lon&quot;
      }
    ],
    &quot;metadata_mappings&quot;: [
      {
        &quot;from_name&quot;: &quot;utc_date&quot;,
        &quot;to_name&quot;: &quot;timestamp&quot;
      }
    ]
  }
}
</code></pre><p>More detailed descriptions of fields are:</p>
<p><code>col_name_row</code> -  Row number of where the column names are.<br><code>skip_rows</code> - Number of rows that the parser should skip at the top of the file before expecting valid CSV data. This will usually be the number of lines taken up by the header.<br><code>name</code> - A short name describing this file type.<br><code>code</code> - The default code for this file type.<br><code>description</code> - A longer description of this file type, in language that makes sense to configurators and coordinators.<br><code>dataset</code> - The code of the dataset that this file type should be stored in after being parsed.<br><code>dataset_version</code> - The version of the dataset schema that will be used to store data from files of this type.<br><code>parse_by</code> - Must be &#39;column_name&#39; or  &#39;column_index&#39;.<br><code>date_format</code> - Defines how your date and/or timestamp are formatted. Common formats are: &quot;yyyy-MM-dd HH:mm:ss&quot; or &quot;MM/dd/yyyy HH:mm:ss&quot;.<br><code>data_mappings</code> - An array of field mappings. The mappings define how data in an uploaded file is converted into JSON before being sent to the PiLR API as raw data.<br><code>metadata_mappings</code> - A similar array of mappings but for metadata. This includes id, pt (participant), and timestamp.<br><code>from_name</code> - The variable name read in from the specified row of column names (col_name_row).<br><code>to_name</code> - The associated variable name in the PiLR dataset.  </p>
<h2 id="creating-a-dataset-schema">Creating a Dataset Schema</h2>
<p>To add an individual dataset, you can access a web form under the &quot;<em>Configuration</em>&quot; tab, followed by &quot;<em>Datasets and Files</em>&quot; on the left-hand sidebar.  </p>
<p>The following sample dataset schema can be used as a starting point for creating your own datasets. The sample schema matches the sample filetype above. You will need only need to change or add to the contents of the &quot;fields&quot; array to match your desired data. If you are reading the data in from a csv, the &quot;name&quot; field should match the &quot;to_name&quot; field in your filetype definition.</p>
<pre><code>{
    &quot;type&quot;: &quot;object&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;timestamp&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;category&quot;: &quot;date&quot;
        },
        {
            &quot;name&quot;: &quot;lat&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;doc&quot;: &quot;Latitude&quot;
        },
        {
            &quot;name&quot;: &quot;lon&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;doc&quot;: &quot;Longitude&quot;
        }
    ]
}
</code></pre><p>More detailed descriptions of the fields are:</p>
<p><code>name</code> - Required. The name of the data variable.<br><code>type</code> - Required. This must be either &quot;string&quot; or &quot;number&quot;.<br><code>category</code> - Optional. Currently the only option is &quot;date&quot;.<br><code>doc</code> - Optional. A brief description of the variable.  </p>
<h2 id="creating-an-instrument-definition-wip-">Creating an Instrument Definition (WIP)</h2>
<p>&quot;Instruments&quot; is the abstract term we use in the PILR platform for a bundle of capabilities that interact with project participants. An instrument definition contains settings, configurations, and one or more datasets associated with that instrument. When you add an instrument to your project, these datasets and settings will automatically come with it.</p>
<p>The following sample instrument definition contains two datasets: lat/lon data, and physical activity monitoring data. It also contains one setting for recording the frequency of data collection.  </p>

</article>


  <!-- add all script tags here -->
  <script src = "/documentation/assets/javascripts/bower.js"></script>
  </body>
</html>


